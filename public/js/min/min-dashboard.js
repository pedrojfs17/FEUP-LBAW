const projectsDiv=document.getElementById("projects"),projectsSpinner=document.getElementById("projectsSpinner");function receivedProjects(e){projectsDiv.innerHTML=JSON.parse(e),projectsSpinner.classList.add("d-none");let t=document.getElementsByClassName("paginator-link");Array.from(t).forEach(e=>e.addEventListener("click",function(){projectsDiv.innerHTML="",projectsSpinner.classList.remove("d-none"),sendGetRequest(e.dataset.href+"&"+encodeForAjax(getProjectActiveFilters()))}))}function sendGetRequest(e){let t=new XMLHttpRequest;t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&(200===t.status?receivedProjects(this.responseText):alert("There was an error "+t.status))},t.open("GET",e,!0),t.setRequestHeader("Accept","application/json"),t.send()}const searchBar=document.getElementById("searchProjects"),searchButton=document.getElementById("button-search-projects");searchBar.addEventListener("keyup",function(){projectsDiv.innerHTML="",projectsSpinner.classList.remove("d-none"),sendGetRequest("api/project?query="+searchBar.value.trim())}),searchButton.addEventListener("click",function(){projectsDiv.innerHTML="",projectsSpinner.classList.remove("d-none"),sendGetRequest("api/project?query="+searchBar.value.trim())}),window.onload=function(){sendGetRequest("api/project")};const membersSearchBar=document.getElementById("searchMembers"),membersSearchButton=document.getElementById("button-search-members"),membersDiv=document.getElementById("members"),membersSpinner=document.getElementById("membersSpinner"),selectedMembers=document.getElementById("selected-members"),addedMembers=document.getElementById("added-members");membersSearchBar.addEventListener("keyup",function(){membersDiv.innerHTML="",membersSpinner.classList.remove("d-none"),sendGetMembersRequest("/profile?query="+membersSearchBar.value.trim())}),membersSearchButton.addEventListener("click",function(){membersDiv.innerHTML="",membersSpinner.classList.remove("d-none"),sendGetMembersRequest("/profile?query="+membersSearchBar.value.trim())});let selectedIds=[];function receivedMembers(e){membersDiv.innerHTML=JSON.parse(e),membersSpinner.classList.add("d-none"),document.querySelectorAll(".add-member-btn").forEach(function(e){selectedIds.includes(e.dataset.id)&&(e.style.visibility="hidden"),e.addEventListener("click",function(){console.log("oi"),selectedMembers.innerHTML+='<option value="'+e.dataset.id+'" selected></option>',selectedIds.push(e.dataset.id);let t=e.parentElement.parentElement.cloneNode(!0),n=t.querySelector("button");n.classList.remove("add-member-btn"),n.classList.add("remove-member-btn"),n.innerHTML="Remove",addedMembers.firstElementChild.classList.contains("text-muted")&&(addedMembers.innerHTML=""),addedMembers.appendChild(t),n.addEventListener("click",function(){let e=selectedMembers.querySelector('option[value="'+n.dataset.id+'"]');selectedMembers.removeChild(e),addedMembers.removeChild(n.parentElement.parentElement),""===addedMembers.innerHTML&&(addedMembers.innerHTML="<p class='text-muted'>No members added!</p>");let t=document.querySelector('.add-member-btn[data-id="'+n.dataset.id+'"]');null!=t&&(t.style.visibility="visible"),selectedIds.splice(selectedIds.indexOf(n.dataset.id))}),e.style.visibility="hidden"})});let t=document.getElementsByClassName("paginator-link");Array.from(t).forEach(e=>e.addEventListener("click",function(){membersDiv.innerHTML="",membersSpinner.classList.remove("d-none"),sendGetMembersRequest(e.dataset.href)}))}function sendGetMembersRequest(e){let t=new XMLHttpRequest;t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&(200===t.status?receivedMembers(this.responseText):alert("There was an error "+t.status))},t.open("GET",e,!0),t.setRequestHeader("Accept","application/json"),t.send()}
